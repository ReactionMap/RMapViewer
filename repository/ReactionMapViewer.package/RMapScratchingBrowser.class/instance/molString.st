private
molString
	^ String
		new: 0
		streamContents: [ :stream | 
			| printInt printFloat molecule |
			printInt := [ :int | int printString padLeftTo: 3 ].
			printFloat := [ :float | (float printShowingDecimalPlaces: 4) padLeftTo: 10 ].
			molecule := scratcherMorph moleculeGeometry.
			stream
				cr;
				nextPutAll: 'generated by Jun4Pharo';
				cr;
				cr.
			stream
				nextPutAll: (printInt value: molecule numberOfAtoms);
				nextPutAll: (printInt value: molecule numberOfBonds);
				nextPutAll: (printInt value: 0);
				nextPutAll: (printInt value: 0);
				nextPutAll: (printInt value: 1);
				nextPutAll: (printInt value: 0);
				nextPutAll: (printInt value: 0);
				nextPutAll: (printInt value: 0);
				nextPutAll: (printInt value: 0);
				nextPutAll: (printInt value: 0);
				nextPutAll: (printInt value: 1);
				nextPutAll: ' V2000';
				cr.
			molecule
				atomsDo: [ :atom | 
					stream
						nextPutAll: (printFloat value: atom position x);
						nextPutAll: (printFloat value: atom position y);
						nextPutAll: (printFloat value: atom position z);
						nextPutAll: (atom symbol padLeftTo: 3);
						nextPutAll: ' 0';
						nextPutAll: '  0';
						nextPutAll: '  0';
						nextPutAll: '  1';
						nextPutAll: '  0';
						nextPutAll: '  0';
						nextPutAll: '  0';
						nextPutAll: '   ';
						nextPutAll: '   ';
						nextPutAll: '  1';
						nextPutAll: '  0';
						nextPutAll: '  0';
						cr ].
			molecule
				bondsDo: [ :bond | 
					stream
						nextPutAll: (printInt value: (molecule indexOfAtom: bond atom1));
						nextPutAll: (printInt value: (molecule indexOfAtom: bond atom2));
						nextPutAll: (printInt value: bond order);
						nextPutAll:
								(bond order = 1
										ifTrue: [ 
											printInt
												value:
													(bond wedge = #flat
														ifTrue: [ 0 ]
														ifFalse: [ 
															bond wedge = #up
																ifTrue: [ 1 ]
																ifFalse: [ 
																	bond wedge = #down
																		ifTrue: [ 6 ]
																		ifFalse: [ 4 ] ] ]) ]
										ifFalse: [ printInt value: 0 ]);
						nextPutAll: '   ';
						nextPutAll: (printInt value: 0);
						nextPutAll: (printInt value: 0);
						cr ].
			stream
				nextPutAll: 'M END';
				cr;
				nextPutAll: '$$$$';
				cr ]